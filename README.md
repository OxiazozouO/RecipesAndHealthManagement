# RecipesAndHealthManagement

基于Web的食谱与健康管理平台

## 技术栈说明
- **后端**：ASP.NET Core（C#），使用RESTful Web API架构
- **前端管理端**：HTML5+CSS3+JavaScript，基于layui框架的X-Admin模板二次开发
- **移动端**：Xamarin（C#）开发Android原生应用
- **数据库**：MySQL，通过EF Core实现ORM映射
- **开发工具**：Visual Studio 2022、JetBrains Rider 2024.1.6

## 系统架构
### 2.1 前后端分离架构
前后端通过标准API接口交互，前端负责用户界面（HTML/CSS/JS），后端提供数据服务（C# + ASP.NET Core Web API），实现开发解耦与性能优化。

### 2.2 Xamarin 框架
基于C#的跨平台移动开发方案，支持Android原生应用开发，通过统一接口调用硬件功能，大幅降低跨平台开发成本。

### 2.3 ASP.NET Core 框架
微软新一代跨平台框架，支持Windows/Linux/macOS部署，内置依赖注入、中间件机制，适合高并发场景。

### 2.4 EF Core 框架
轻量化ORM工具，通过LINQ语法操作数据库，支持MySQL等多数据库，自动生成C#实体模型，简化数据访问层开发。

### 2.5 膳食营养素参考摄入量（DRIs）
基于《中国居民膳食营养素参考摄入量（2023版）》，核心指标包括：
- EAR（平均需要量）：满足50%个体需求
- RNI（推荐摄入量）：满足97-98%个体需求
- UL（可耐受最高摄入量）：安全上限  
  通过公式计算个体营养摄入不足/过量风险，支持能量代谢评估（BMR/TDEE计算）。

### 2.6 能量代谢模型
- **基础代谢率（BMR）**：采用Mifflin-St Jeor方程计算
```
男性：REE = 9.99× 体重 (kg) + 6.25× 身高 (cm) - 4.92× 年龄 + 5
女性：REE = 9.99× 体重 (kg) + 6.25× 身高 (cm) - 4.92× 年龄 - 161
```
- **每日总能量消耗（TDEE）**：TDEE = BMR × 身体活动水平（PAL），支持减脂/增肌等场景的能量规划。

### 2.7 三大营养素约束
基于AMDR（可接受范围）：
- 碳水化合物：50-65%能量占比
- 脂肪：20-30%能量占比
- 蛋白质：10-20%能量占比  
  通过公式实现摄入量与能量占比的动态校验。

## 系统需求
### 3.1 可行性分析
- **经济**：减少人工成本，降低医疗支出，低成本高回报
- **技术**：前后端分离架构，ASP.NET Core + Xamarin + layui技术栈，支持跨平台扩展

### 3.2 安全性设计
- 角色权限控制（管理员/审核员/普通用户）
- JWT令牌认证，数据加密存储
- 客户端/服务端双重数据校验，事务机制保证数据一致性

### 3.3 功能模块
#### 用户端（Android App）
- 核心功能：用户认证、体征管理、饮食记录、营养分析（含BMI/TDEE计算）、UGC内容发布
- 辅助功能：收藏管理、分类标签、举报反馈、评论互动

#### 审核端
- 初审筛查：内容合规性检查（食材/食谱/合集）
- 分类管理：标签维护
- 举报处理：违规内容下架

#### 管理端（Web后台）
- 账户管理：用户/角色/权限配置
- 资源管理：食材/食谱/合集的全生命周期管理
- 系统维护：数据备份/还原、文件管理、运行状态监控

### 3.4 非功能性需求
- 安全性：角色隔离，数据加密传输存储
- 可维护性：组件化设计，支持模块化扩展
- 可靠性：数据库备份机制，接口异常处理
- 合规性：用户隐私保护，营养模型符合国家标准

## 部署指南
1. **安装MySQL数据库**  
   需提前安装MySQL（建议版本5.7及以上），用于存储平台核心数据。安装完成后，确保MySQL服务正常运行。

2. **配置后端数据库连接**  
   后端服务（`RecipesAndHealthManagement\WebServer`目录）需通过`.my.cnf`文件配置MySQL连接信息（如数据库地址、用户名、密码等）。请根据实际环境修改该文件，确保后端能正确连接数据库。

3. **初始化数据库**  
   运行项目提供的数据库脚本`RecipesAndHealthManagement\Database\db.sql`，用于创建数据库表结构及初始化基础数据（如营养成分标准、用户角色等）。可通过MySQL命令行工具或图形化工具（如Navicat）执行该脚本。

4. **启动后端服务**  
   先启动后端服务：进入`RecipesAndHealthManagement\WebServer`目录，通过`dotnet run`命令启动ASP.NET Core应用（默认监听5000端口）。后端启动后，会提供API接口供前端和移动端调用。

5. **启动前端管理端**  
   后端启动后，启动前端管理端：进入`RecipesAndHealthManagement\Admin\index`目录（或直接打开`index.html`文件），通过静态服务器（如Nginx、Apache或Python内置`http.server`）托管前端页面，访问管理后台。

6. **启动移动端应用**  
   最后启动安卓用户端：通过Visual Studio打开`RecipesAndHealthManagement\Android`项目，编译生成APK安装包并安装到设备，或通过模拟器运行调试。

### 4.1 注意事项
- 启动顺序需严格遵循“后端→前端→移动端”，确保接口调用与数据交互正常。
- `.my.cnf`配置文件需根据实际环境（如本地开发/生产部署）调整，避免硬编码敏感信息。
- 前端为纯HTML+CSS+JS静态页面，无需Node.js环境，直接通过静态服务器托管即可运行。

## 开发相关说明
- **参考资料路径**：后端开发涉及的营养标准、公式等参考资料（如《中国居民膳食营养素参考摄入量（2023版）》数据），主要存放在`D:\RecipesAndHealthManagement\Database\`目录（根据实际环境调整路径）。
- **数据库模型更新**：若需更新EF Core数据库模型（如修改表结构），可运行`RecipesAndHealthManagement\Database\脚本.bat`脚本，自动同步数据库与代码模型（需提前配置好数据库连接）。
- **前端开发工具**：前端管理端开发时，`RecipesAndHealthManagement\Admin\src\configuration\tool\`目录提供了多个辅助工具（如数据校验插件、样式调试工具等），可直接调用以提升开发效率。  